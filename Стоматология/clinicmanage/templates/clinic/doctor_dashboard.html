{% extends 'clinic/base.html' %}
{% load static %}

{% block content %}
<!-- –ü–∞–Ω–µ–ª—å –≤—Ä–∞—á–∞ -->
<section class="services" style="padding: 5rem 0; background: #f8f9fa;">
  <div class="container">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <h2 class="section-title text-center mb-5" style="color: #0d98ba; font-family: 'Arial', sans-serif;">
      –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –¥–æ–∫—Ç–æ—Ä {{ doctor.get_full_name }}
    </h2>

    <!-- –ö–Ω–æ–ø–∫–∞ "–í—Å–µ –ø–∞—Ü–∏–µ–Ω—Ç—ã" -->
    <div class="text-center mb-5">
      <a href="{% url 'patient-list' %}" class="hero-btn primary" style="padding: 1rem 2.5rem; font-size: 1.5rem; font-weight: 600; border: none;">
        –í—Å–µ –ø–∞—Ü–∏–µ–Ω—Ç—ã
      </a>
    </div>

    <!-- –í–∏–∑–∏—Ç—ã —Å–µ–≥–æ–¥–Ω—è -->
    <div class="service-card mb-5">
      <div class="service-header">
        <h3 class="service-title">–í–∏–∑–∏—Ç—ã —Å–µ–≥–æ–¥–Ω—è</h3>
      </div>
      <div class="service-body">
        {% if today_appointments %}
        <table class="table table-bordered" style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
          <thead>
          <tr style="background-color: #d1f1ff; color: #007bff;">
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–ü–∞—Ü–∏–µ–Ω—Ç</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–í—Ä–µ–º—è</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–ñ–∞–ª–æ–±—ã</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–ü—Ä–∏—à—ë–ª</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–î–æ–∫—É–º–µ–Ω—Ç—ã</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
          </thead>
          <tbody>
          {% for app in today_appointments %}
          <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.patient.get_full_name }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.appointment_date|time:"H:i" }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.description|default:"‚Äî" }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">
              {% if app.is_attended == True %}‚úÖ –ü—Ä–∏—à—ë–ª
              {% elif app.is_attended == False %}‚ùå –ù–µ –ø—Ä–∏—à—ë–ª
              {% else %}‚Äî{% endif %}
            </td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.comment|default:"‚Äî" }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">
              {% if app.documents.all %}
              {% for doc in app.documents.all %}
              <div class="mb-1">
                <a href="{{ doc.file.url }}" target="_blank" class="text-decoration-none" style="color: #007bff;">
                  {% if doc.file.url|slice:"-4:" in ".jpg,.jpeg,.png,.gif" %}
                  üñº
                  {% elif doc.file.url|slice:"-4:" == ".pdf" %}
                  üìÑ
                  {% else %}
                  üìé
                  {% endif %}
                </a>
              </div>
              {% endfor %}
              {% else %}
              ‚Äî
              {% endif %}
            </td>
            <td style="padding: 10px; border: 1px solid #ddd;">
              <a href="{% url 'doctor-appointment-detail' app.id %}" class="hero-btn primary" style="padding: 8px 12px; font-size: 1.3rem; display: inline-block;">–û—Ç–∫—Ä—ã—Ç—å</a>
            </td>
          </tr>
          {% endfor %}
          </tbody>
        </table>
        {% else %}
        <p class="text-muted">–°–µ–≥–æ–¥–Ω—è –Ω–µ—Ç –ø—Ä–∏—ë–º–æ–≤.</p>
        {% endif %}
      </div>
    </div>

    <!-- –ë—É–¥—É—â–∏–µ –≤–∏–∑–∏—Ç—ã -->
    <div class="service-card mb-5">
      <div class="service-header">
        <h3 class="service-title">–ë—É–¥—É—â–∏–µ –≤–∏–∑–∏—Ç—ã</h3>
      </div>
      <div class="service-body">
        <p class="text-muted" style="font-size: 1.4rem; margin-bottom: 1rem;">
          –ú–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –∏ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã (–æ–Ω–∏ –æ—Ç—Ä–∞–∑—è—Ç—Å—è —É –ø–∞—Ü–∏–µ–Ω—Ç–∞). –≠—Ç–æ —É–¥–æ–±–Ω–æ –¥–ª—è –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–µ–π, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–æ –ø—Ä–∏—ë–º–∞.
        </p>
        {% if future_appointments %}
        <table class="table table-bordered" style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
          <thead>
          <tr style="background-color: #d4f8e8; color: #28a89c;">
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–ü–∞—Ü–∏–µ–Ω—Ç</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–ñ–∞–ª–æ–±—ã</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–î–æ–∫—É–º–µ–Ω—Ç—ã</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
          </thead>
          <tbody>
          {% for app in future_appointments %}
          <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.patient.get_full_name }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.appointment_date|date:"d.m.Y H:i" }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.description|default:"‚Äî" }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.comment|default:"‚Äî" }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">
              {% if app.documents.all %}
              {% for doc in app.documents.all %}
              <div class="mb-1">
                <a href="{{ doc.file.url }}" target="_blank" class="text-decoration-none" style="color: #007bff;">
                  {% if doc.file.url|slice:"-4:" in ".jpg,.jpeg,.png,.gif" %}
                  üñº
                  {% elif doc.file.url|slice:"-4:" == ".pdf" %}
                  üìÑ
                  {% else %}
                  üìé
                  {% endif %}
                </a>
              </div>
              {% endfor %}
              {% else %}
              ‚Äî
              {% endif %}
            </td>
            <td style="padding: 10px; border: 1px solid #ddd;">
              <a href="{% url 'doctor-appointment-detail' app.id %}" class="hero-btn primary" style="padding: 8px 12px; font-size: 1.3rem; display: inline-block;">–û—Ç–∫—Ä—ã—Ç—å</a>
            </td>
          </tr>
          {% endfor %}
          </tbody>
        </table>
        {% else %}
        <p class="text-muted">–ù–µ—Ç –±—É–¥—É—â–∏—Ö –ø—Ä–∏—ë–º–æ–≤.</p>
        {% endif %}
      </div>
    </div>

    <!-- –ü—Ä–æ—à–µ–¥—à–∏–µ –≤–∏–∑–∏—Ç—ã -->
    <div class="service-card mb-5">
      <div class="service-header">
        <h3 class="service-title">–ü—Ä–æ—à–µ–¥—à–∏–µ –≤–∏–∑–∏—Ç—ã</h3>
      </div>
      <div class="service-body">
        {% if past_appointments %}
        <table class="table table-bordered" style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
          <thead>
          <tr style="background-color: #e9ecef; color: #495057;">
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–ü–∞—Ü–∏–µ–Ω—Ç</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–ñ–∞–ª–æ–±—ã</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–ü—Ä–∏—à—ë–ª</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–î–æ–∫—É–º–µ–Ω—Ç—ã</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
          </thead>
          <tbody>
          {% for app in past_appointments %}
          <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.patient.get_full_name }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.appointment_date|date:"d.m.Y H:i" }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.description|default:"‚Äî" }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">
              {% if app.is_attended == True %}‚úÖ –ü—Ä–∏—à—ë–ª
              {% elif app.is_attended == False %}‚ùå –ù–µ –ø—Ä–∏—à—ë–ª
              {% else %}‚Äî{% endif %}
            </td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ app.comment|default:"‚Äî" }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">
              {% if app.documents.all %}
              {% for doc in app.documents.all %}
              <div class="mb-1">
                <a href="{{ doc.file.url }}" target="_blank" class="text-decoration-none" style="color: #007bff;">
                  {% if doc.file.url|slice:"-4:" in ".jpg,.jpeg,.png,.gif" %}
                  üñº
                  {% elif doc.file.url|slice:"-4:" == ".pdf" %}
                  üìÑ
                  {% else %}
                  üìé
                  {% endif %}
                </a>
              </div>
              {% endfor %}
              {% else %}
              ‚Äî
              {% endif %}
            </td>
            <td style="padding: 10px; border: 1px solid #ddd;">
              <a href="{% url 'doctor-appointment-detail' app.id %}" class="hero-btn primary" style="padding: 8px 12px; font-size: 1.3rem; display: inline-block;">–ü—Ä–æ—Å–º–æ—Ç—Ä</a>
            </td>
          </tr>
          {% endfor %}
          </tbody>
        </table>
        {% else %}
        <p class="text-muted">–ù–µ—Ç –ø—Ä–æ—à–ª—ã—Ö –ø—Ä–∏—ë–º–æ–≤.</p>
        {% endif %}
      </div>
    </div>
  </div>
</section>

{% endblock %}